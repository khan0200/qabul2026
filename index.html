<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Qabul - Student Consultation Manager</title>
    <link rel="icon" href="data:,">
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <!-- Bootstrap 5.3 -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Bootstrap Icons -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
    <link rel="stylesheet" href="style.css">
</head>

<body>

    <main class="container mt-4 mb-5">
        <!-- Dashboard Header -->
        <div class="row mb-4 align-items-center">
            <div class="col-md-6">
                <h1 class="page-title">Students Registry</h1>
                <p class="text-muted">First contact and needs identification</p>
            </div>
            <div class="col-md-6 text-md-end">
                <button class="btn btn-primary btn-lg rounded-pill shadow-sm" data-bs-toggle="modal"
                    data-bs-target="#addStudentModal">
                    <i class="bi bi-plus-lg me-2"></i> Add Student
                </button>
            </div>
        </div>

        <!-- Search & Filter Section -->
        <div class="glass-card mb-4 p-3 hstack gap-3 flex-wrap">
            <div class="search-wrapper flex-grow-1">
                <i class="bi bi-search"></i>
                <input type="text" id="studentSearch" class="form-control" placeholder="Search by name or phone...">
            </div>
            <div class="filter-wrapper">
                <select id="levelFilter" class="form-select">
                    <option value="">All Education Levels</option>
                    <option value="KOLLEJ">KOLLEJ</option>
                    <option value="BAKALAVR">BAKALAVR</option>
                    <option value="MAGISTR">MAGISTR</option>
                    <option value="MAGISTR SERTIFIKATSIZ">MAGISTR SERTIFIKATSIZ</option>
                    <option value="REGIONAL (TELEX)">REGIONAL (TELEX)</option>
                    <option value="1% TOP">1% TOP</option>
                </select>
            </div>
        </div>

        <!-- Students List Placeholder -->
        <div class="row" id="studentsList">
            <!-- Dynamic content will go here -->
            <div class="col-12 text-center py-5">
                <div class="spinner-border text-primary" role="status">
                    <span class="visually-hidden">Loading...</span>
                </div>
                <p class="mt-2">Connecting to Firestore...</p>
            </div>
        </div>
    </main>

    <!-- Modal for New Student -->
    <div class="modal fade" id="addStudentModal" tabindex="-1" aria-labelledby="addStudentModalLabel"
        aria-hidden="true">
        <div class="modal-dialog modal-lg modal-dialog-centered">
            <div class="modal-content border-0 overflow-hidden rounded-4 shadow-lg">
                <div class="modal-header bg-primary text-white p-4">
                    <h5 class="modal-title fw-bold" id="addStudentModalLabel">
                        <i class="bi bi-person-plus-fill me-2"></i> New Student Admission
                    </h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"
                        aria-label="Close"></button>
                </div>
                <div class="modal-body p-4">
                    <form id="addStudentForm" class="row g-3">
                        <!-- Personal Info -->
                        <div class="col-md-6">
                            <label class="form-label fw-semibold">NAME (UPPERCASE)</label>
                            <input type="text" id="studentName" class="form-control text-uppercase"
                                placeholder="JON DOE" required>
                        </div>
                        <div class="col-md-6">
                            <label class="form-label fw-semibold">Phone Number</label>
                            <input type="text" id="studentPhone" class="form-control" placeholder="99-123-45-67"
                                maxlength="14" required>
                        </div>

                        <!-- Education & Certificates -->
                        <div class="col-md-6">
                            <label class="form-label fw-semibold">University Level</label>
                            <select id="eduLevel" class="form-select" required>
                                <option value="" disabled selected>Choose Level...</option>
                                <option value="KOLLEJ">KOLLEJ</option>
                                <option value="BAKALAVR">BAKALAVR</option>
                                <option value="MAGISTR">MAGISTR</option>
                                <option value="MAGISTR SERTIFIKATSIZ">MAGISTR SERTIFIKATSIZ</option>
                                <option value="REGIONAL (TELEX)">REGIONAL (TELEX)</option>
                                <option value="1% TOP">1% TOP</option>
                            </select>
                        </div>
                        <div class="col-md-6">
                            <label class="form-label fw-semibold">Choose Universities</label>
                            <div class="dropdown w-100" id="uniDropdown">
                                <button
                                    class="form-select text-start d-flex justify-content-between align-items-center w-100"
                                    type="button" id="multiSelectBtn" data-bs-toggle="dropdown"
                                    data-bs-auto-close="outside" aria-expanded="false">
                                    <span id="selectedCountText">First select level...</span>
                                </button>
                                <div class="dropdown-menu w-100 p-3 shadow-lg border-0 rounded-3"
                                    aria-labelledby="multiSelectBtn" style="max-height: 300px; overflow-y: auto;">
                                    <div id="universityCheckboxes">
                                        <div class="text-muted small">First select level...</div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="col-12">
                            <label class="form-label fw-semibold">Language Proficiency & Details</label>
                            <div class="input-group">
                                <select id="languageLevel" class="form-select" style="max-width: 250px;" required>
                                    <option value="" disabled selected>Level...</option>
                                    <option value="IELTS EXPECTED">IELTS EXPECTED</option>
                                    <option value="TOPIK EXPECTED">TOPIK EXPECTED</option>
                                    <option value="SKA EXPECTED">SKA EXPECTED</option>
                                    <option value="IELTS">IELTS</option>
                                    <option value="TOPIK">TOPIK </option>
                                    <option value="SKA">SKA</option>
                                    <option value="NO CERTIFICATE">NO CERTIFICATE</option>
                                </select>
                                <input type="text" id="languageDetail" class="form-control"
                                    placeholder="Specifics (Score, Date, etc.)">
                            </div>
                        </div>

                        <!-- Family Details -->
                        <div class="col-md-6 mb-3">
                            <label class="form-label fw-semibold">Father's Condition</label>
                            <div class="card bg-light border-0">
                                <div class="card-body p-2">
                                    <div id="fatherConditions" class="scroll-y" style="max-height: 150px;">
                                        <div class="form-check custom-check mb-2">
                                            <input class="form-check-input" type="checkbox" value="RASMIY DAROMADI BOR"
                                                id="f_daromad_bor">
                                            <label class="form-check-label small fw-medium text-dark"
                                                for="f_daromad_bor">RASMIY DAROMADI BOR</label>
                                        </div>
                                        <div class="form-check custom-check mb-2">
                                            <input class="form-check-input" type="checkbox" value="RASMIY DAROMADI YO'Q"
                                                id="f_daromad_yoq">
                                            <label class="form-check-label small fw-medium text-dark"
                                                for="f_daromad_yoq">RASMIY DAROMADI YO'Q</label>
                                        </div>
                                        <div class="form-check custom-check mb-2">
                                            <input class="form-check-input" type="checkbox" value="CHET ELDA ISHLAYDI"
                                                id="f_chet_elda">
                                            <label class="form-check-label small fw-medium text-dark"
                                                for="f_chet_elda">CHET ELDA ISHLAYDI</label>
                                        </div>
                                        <div class="form-check custom-check mb-2">
                                            <input class="form-check-input" type="checkbox" value="NOMIDA UY BOR"
                                                id="f_uy_bor">
                                            <label class="form-check-label small fw-medium text-dark"
                                                for="f_uy_bor">NOMIDA UY BOR</label>
                                        </div>
                                        <div class="form-check custom-check mb-2">
                                            <input class="form-check-input" type="checkbox"
                                                value="NOMIDA UY BOR KADASTR YO'Q" id="f_kadastr_yoq">
                                            <label class="form-check-label small fw-medium text-dark"
                                                for="f_kadastr_yoq">NOMIDA UY BOR KADASTR YO'Q</label>
                                        </div>
                                        <div class="form-check custom-check mb-2">
                                            <input class="form-check-input" type="checkbox" value="NOMIDA UY YO'Q"
                                                id="f_uy_yoq">
                                            <label class="form-check-label small fw-medium text-dark"
                                                for="f_uy_yoq">NOMIDA UY YO'Q</label>
                                        </div>
                                        <div class="form-check custom-check mb-2">
                                            <input class="form-check-input" type="checkbox" value="TADBIRKOR"
                                                id="f_tadbirkor">
                                            <label class="form-check-label small fw-medium text-dark"
                                                for="f_tadbirkor">TADBIRKOR</label>
                                        </div>
                                        <div class="form-check custom-check mb-2">
                                            <input class="form-check-input" type="checkbox" value="AJRASHGAN"
                                                id="f_ajrashgan">
                                            <label class="form-check-label small fw-medium text-dark"
                                                for="f_ajrashgan">AJRASHGAN</label>
                                        </div>
                                        <div class="form-check custom-check mb-2">
                                            <input class="form-check-input" type="checkbox" value="VAFOT ETGAN"
                                                id="f_vafot">
                                            <label class="form-check-label small fw-medium text-dark"
                                                for="f_vafot">VAFOT ETGAN</label>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="col-md-6 mb-3">
                            <label class="form-label fw-semibold">Mother's Condition</label>
                            <div class="card bg-light border-0">
                                <div class="card-body p-2">
                                    <div id="motherConditions" class="scroll-y" style="max-height: 150px;">
                                        <div class="form-check custom-check mb-2">
                                            <input class="form-check-input" type="checkbox" value="RASMIY DAROMADI BOR"
                                                id="m_daromad_bor">
                                            <label class="form-check-label small fw-medium text-dark"
                                                for="m_daromad_bor">RASMIY DAROMADI BOR</label>
                                        </div>
                                        <div class="form-check custom-check mb-2">
                                            <input class="form-check-input" type="checkbox" value="RASMIY DAROMADI YO'Q"
                                                id="m_daromad_yoq">
                                            <label class="form-check-label small fw-medium text-dark"
                                                for="m_daromad_yoq">RASMIY DAROMADI YO'Q</label>
                                        </div>
                                        <div class="form-check custom-check mb-2">
                                            <input class="form-check-input" type="checkbox" value="CHET ELDA ISHLAYDI"
                                                id="m_chet_elda">
                                            <label class="form-check-label small fw-medium text-dark"
                                                for="m_chet_elda">CHET ELDA ISHLAYDI</label>
                                        </div>
                                        <div class="form-check custom-check mb-2">
                                            <input class="form-check-input" type="checkbox" value="NOMIDA UY BOR"
                                                id="m_uy_bor">
                                            <label class="form-check-label small fw-medium text-dark"
                                                for="m_uy_bor">NOMIDA UY BOR</label>
                                        </div>
                                        <div class="form-check custom-check mb-2">
                                            <input class="form-check-input" type="checkbox"
                                                value="NOMIDA UY BOR KADASTR YO'Q" id="m_kadastr_yoq">
                                            <label class="form-check-label small fw-medium text-dark"
                                                for="m_kadastr_yoq">NOMIDA UY BOR KADASTR YO'Q</label>
                                        </div>
                                        <div class="form-check custom-check mb-2">
                                            <input class="form-check-input" type="checkbox" value="NOMIDA UY YO'Q"
                                                id="m_uy_yoq">
                                            <label class="form-check-label small fw-medium text-dark"
                                                for="m_uy_yoq">NOMIDA UY YO'Q</label>
                                        </div>
                                        <div class="form-check custom-check mb-2">
                                            <input class="form-check-input" type="checkbox" value="TADBIRKOR"
                                                id="m_tadbirkor">
                                            <label class="form-check-label small fw-medium text-dark"
                                                for="m_tadbirkor">TADBIRKOR</label>
                                        </div>
                                        <div class="form-check custom-check mb-2">
                                            <input class="form-check-input" type="checkbox" value="AJRASHGAN"
                                                id="m_ajrashgan">
                                            <label class="form-check-label small fw-medium text-dark"
                                                for="m_ajrashgan">AJRASHGAN</label>
                                        </div>
                                        <div class="form-check custom-check mb-2">
                                            <input class="form-check-input" type="checkbox" value="VAFOT ETGAN"
                                                id="m_vafot">
                                            <label class="form-check-label small fw-medium text-dark"
                                                for="m_vafot">VAFOT ETGAN</label>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="col-12 mt-2">
                            <label class="form-label fw-semibold">Additional Notes</label>
                            <textarea id="studentNotes" class="form-control" rows="3"
                                placeholder="Any extra information about the student..."></textarea>
                        </div>

                        <div class="col-12 mt-4 d-flex gap-2">
                            <button type="submit" class="btn btn-primary px-4 py-2" id="submitBtn">
                                <span class="spinner-border spinner-border-sm me-2 d-none" role="status"
                                    aria-hidden="true"></span>
                                Save Student
                            </button>
                            <button type="button" class="btn btn-outline-secondary px-4 py-2"
                                data-bs-dismiss="modal">Cancel</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <!-- Student Details Modal -->
    <div class="modal fade" id="studentDetailsModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered modal-lg">
            <div class="modal-content overflow-hidden border-0 shadow-lg" style="border-radius: 16px;">
                <div class="modal-header bg-primary text-white p-3 border-0">
                    <div>
                        <h6 class="text-uppercase mb-0 opacity-75 fw-bold"
                            style="letter-spacing: 1px; font-size: 0.65rem;">KOREYADA TA'LIM</h6>
                        <h5 class="modal-title fw-bold" id="detailStudentName">STUDENT NAME</h5>
                    </div>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"
                        aria-label="Close"></button>
                </div>
                <div class="modal-body p-3 bg-white">
                    <div class="row g-2">
                        <div class="col-md-6">
                            <div class="p-2 rounded-3 bg-light border">
                                <label class="text-muted small fw-bold text-uppercase mb-1 d-block"
                                    style="font-size: 0.65rem;">Phone Number</label>
                                <div class="fw-bold text-dark" id="detailPhone">99-999-99-99</div>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="p-2 rounded-3 bg-light border">
                                <label class="text-muted small fw-bold text-uppercase mb-1 d-block"
                                    style="font-size: 0.65rem;">University Level</label>
                                <span class="badge rounded-2 px-2 py-1 fw-bold" id="detailLevelBadge">LEVEL</span>
                            </div>
                        </div>
                        <div class="col-12">
                            <div class="p-2 rounded-3 border">
                                <label class="text-muted small fw-bold text-uppercase mb-1 d-block"
                                    style="font-size: 0.65rem;">Chosen Universities</label>
                                <div id="detailUniversities" class="d-flex flex-wrap gap-2">
                                    <!-- Universities will be injected here -->
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="p-2 rounded-3 bg-light border">
                                <label class="text-muted small fw-bold text-uppercase mb-1 d-block"
                                    style="font-size: 0.65rem;">Language Proficiency</label>
                                <div class="fw-bold text-dark" id="detailLanguage">Level (Detail)</div>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div
                                class="h-100 p-2 rounded-3 bg-primary bg-opacity-10 border border-primary border-opacity-10">
                                <label class="text-primary small fw-bold mb-1 d-block"
                                    style="font-size: 0.65rem;">MAHSUS TAVSIYA</label>
                                <div class="text-dark small" id="detailSuggestion"
                                    style="font-size: 0.8rem; line-height: 1.2;">Wait for manager's
                                    recommendation...</div>
                            </div>
                        </div>
                        <div class="col-12">
                            <div class="p-2 rounded-3 bg-light border-start border-4 border-warning">
                                <label class="text-warning small fw-bold text-uppercase mb-1 d-block"
                                    style="font-size: 0.65rem;">Additional Notes</label>
                                <p class="mb-0 text-dark small" id="detailNotes" style="white-space: pre-wrap;">No notes
                                    provided.</p>
                            </div>
                        </div>
                        <div class="col-12">
                            <div class="row g-2" id="detailFamilyInfo">
                                <!-- Family info will be injected here -->
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer border-0 p-3 pt-0 bg-white">
                    <button type="button" class="btn btn-sm btn-light px-3 rounded-3 fw-bold"
                        data-bs-dismiss="modal">Close</button>
                    <button type="button"
                        class="btn btn-sm btn-primary px-3 rounded-3 fw-bold d-flex align-items-center gap-2"
                        id="shareBtn">
                        <i class="bi bi-share-fill"></i> Share Card
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>
    <script type="module" src="app.js"></script>
</body>

</html>
